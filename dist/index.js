!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@antv/g6")):"function"==typeof define&&define.amd?define(["@antv/g6"],e):"object"==typeof exports?exports.AntvUnfold=e(require("@antv/g6")):t.AntvUnfold=e(t.G6)}(this,(t=>(()=>{var e={230:(t,e,r)=>{var i=["isExpanded"];function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function h(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}var d=r(418),p=d.Graph,f=d.GraphEvent,y=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.options=this.mergeDefaultOptions(r),this.graph=null,this.isClick=!1,this.data=null,this.isDestroyed=!1,this.isInitializing=!1,this.timeouts=new Set,this.init()},e=[{key:"mergeDefaultOptions",value:function(t){return this.deepMerge({nodeStyle:{size:function(t){return t.size||30},fill:function(t){return t.color||"#FF6B6B"},labelText:function(t){return t.label||""},labelPlacement:"center",labelFill:"#333"},edgeStyle:{stroke:"#aaa"},layout:{type:"d3-force",link:{distance:function(t){var e;return t.source&&t.target&&1===(null===(e=t.source)||void 0===e?void 0:e.layer)?120:100},strength:function(t){return t.source&&t.target,.7}},manyBody:{strength:function(t){return 1===(null==t?void 0:t.layer)?-60:-30}},collide:{radius:40,strength:.8},center:{strength:0},radial:{strength:function(t){return 1===(null==t?void 0:t.layer)?0:2===(null==t?void 0:t.layer)?.001:.01},radius:function(t){return 1===(null==t?void 0:t.layer)?15:2===(null==t?void 0:t.layer)?210:360},x:0,y:0}},behaviors:[{type:"drag-element-force",fixed:!0},{type:"click-select",state:"active"},"zoom-canvas"],toolbar:{enabled:!0,position:"top-left",items:["zoom-in","zoom-out","auto-fit","reset"]},onNodeClick:null,onNodeExpand:null,onGraphReady:null,autoFit:!0,enableNodeExpansion:!0},t)}},{key:"deepMerge",value:function(t,e){var r=l({},t);for(var i in e)e[i]&&"object"===a(e[i])&&!Array.isArray(e[i])?r[i]=this.deepMerge(t[i]||{},e[i]):r[i]=e[i];return r}},{key:"init",value:function(){if(!this.isInitializing&&!this.isDestroyed)if(this.container){this.isInitializing=!0,this.graph&&this.destroy();var t={container:this.container,node:{style:this.options.nodeStyle},edge:{style:this.options.edgeStyle},layout:this.options.layout,behaviors:this.options.behaviors};this.options.toolbar.enabled&&(t.plugins=[this.createToolbarPlugin()]);try{this.graph=new p(t),this.setupEventListeners()}catch(t){console.error("初始化图表时发生错误:",t),this.graph=null}finally{this.isInitializing=!1}}else console.warn("容器元素不存在，无法初始化图表")}},{key:"createToolbarPlugin",value:function(){var t=this;return{type:"toolbar",position:this.options.toolbar.position,onClick:function(e){t.handleToolbarClick(e)},getItems:function(){return t.options.toolbar.items.map((function(t){return{id:t,value:t}}))}}}},{key:"handleToolbarClick",value:function(t){if(!this.isDestroyed&&this.graph)try{switch(t){case"zoom-in":var e=this.graph.getZoom(),r=Math.min(1.2*e,3);this.graph.zoomTo(r,{duration:300,easing:"ease-in-out"});break;case"zoom-out":var i=this.graph.getZoom(),n=Math.max(.8*i,.5);this.graph.zoomTo(n,{duration:300,easing:"ease-in-out"});break;case"auto-fit":this.graph.fitCenter();break;case"reset":this.resetGraph();break;default:console.warn("未知的工具栏操作:",t)}}catch(t){console.warn("处理工具栏点击时发生错误:",t)}}},{key:"setupEventListeners",value:function(){var t=this;this.graph.on(f.BEFORE_RENDER,(function(){if(!t.isClick&&t.options.autoFit&&!t.isDestroyed)try{var e;null===(e=t.graph)||void 0===e||e.fitCenter()}catch(t){console.warn("自动适应中心时发生错误:",t)}})),this.options.enableNodeExpansion&&this.graph.on("node:click",(function(e){t.handleNodeClick(e)}))}},{key:"handleNodeClick",value:function(t){var e=this;if(!this.isDestroyed&&this.graph){this.isClick=!0;var r=t.target;try{var i;if(this.graph.getNodeData(r.id).isExpanded)return void(this.isClick=!1);var n=null===(i=this.data)||void 0===i||null===(i=i.nodes)||void 0===i?void 0:i.find((function(t){return t.id===r.id}));if(!n||!n.children)return void(this.isClick=!1);this.options.onNodeClick&&this.options.onNodeClick(t,n),this.expandNode(r,n.children),this.options.onNodeExpand&&this.options.onNodeExpand(r.id,n.children);var o=setTimeout((function(){e.isDestroyed||(e.isClick=!1),e.timeouts.delete(o)}),20);this.timeouts.add(o)}catch(t){console.warn("处理节点点击时发生错误:",t),this.isClick=!1}}}},{key:"expandNode",value:function(t,e){if(!this.isDestroyed&&this.graph)try{var r=this.graph.getNodeData(),i=this.graph.getEdgeData(),o=e.nodes,a=e.edges,s=[];o.forEach((function(e,i){r.some((function(t){return t.id===e.id}))||s.push(l(l({},e),{},{style:{x:t.style.x+10*i,y:t.style.y+10*i+50}}))}));var u=[];a.forEach((function(t){i.some((function(e){return e.source===t.source&&e.target===t.target}))||u.push(t)}));var c=r.map((function(e){return e.id===t.id?l(l({},e),{},{isExpanded:!0}):e}));this.graph.clear(),this.graph.setData((function(t){return l(l({},t),{},{nodes:[].concat(n(c),s),edges:[].concat(n(i),u)})})),this.graph.stopLayout(),this.graph.render()}catch(t){console.warn("展开节点时发生错误:",t)}}},{key:"setData",value:function(t){var e=this;if(!this.isDestroyed&&this.graph)try{this.data=t,this.graph.setData(t);var r=setTimeout((function(){if(!e.isDestroyed&&e.graph)try{e.graph.render(),e.options.onGraphReady&&e.options.onGraphReady(e.graph)}catch(t){console.warn("渲染图形时发生错误:",t)}e.timeouts.delete(r)}),0);this.timeouts.add(r)}catch(t){console.error("设置数据时发生错误:",t)}else console.warn("图形实例已销毁或不存在，无法设置数据")}},{key:"resetGraph",value:function(){if(!this.isDestroyed&&this.graph&&this.data)try{var t=l(l({},this.data),{},{nodes:this.data.nodes.map((function(t){return t.isExpanded,function(t,e){if(null==t)return{};var r,i,n=function(t,e){if(null==t)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;r[i]=t[i]}return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],-1===e.indexOf(r)&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,i)}))});this.graph.clear(),this.graph.setData(t),this.graph.stopLayout(),this.graph.render(),this.graph.fitCenter()}catch(t){console.warn("重置图表时发生错误:",t)}}},{key:"getGraph",value:function(){return this.graph}},{key:"destroy",value:function(){if(this.isDestroyed=!0,this.isInitializing=!1,this.timeouts.forEach((function(t){clearTimeout(t)})),this.timeouts.clear(),this.graph)try{this.graph.destroy()}catch(t){console.warn("销毁图表时发生错误:",t)}finally{this.graph=null}}},{key:"updateOptions",value:function(t){this.isDestroyed||this.isInitializing||(this.options=this.deepMerge(this.options,t),this.destroy(),this.isDestroyed=!1,this.isInitializing=!1,this.init(),this.data&&this.setData(this.data))}}],e&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();t.exports={GraphVisualizer:y}},418:e=>{"use strict";e.exports=t},954:(t,e,r)=>{"use strict";r.r(e),r.d(e,{GraphVisualizer:()=>i.GraphVisualizer,default:()=>n});var i=r(230);t=r.hmd(t);const n=i.GraphVisualizer;t.exports&&(t.exports=i.GraphVisualizer,t.exports.GraphVisualizer=i.GraphVisualizer)}},r={};function i(t){var n=r[t];if(void 0!==n)return n.exports;var o=r[t]={id:t,loaded:!1,exports:{}};return e[t](o,o.exports,i),o.loaded=!0,o.exports}return i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(954)})()));